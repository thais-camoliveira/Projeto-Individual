<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/style.css">
    <title>Alanzoka | The Last Of Us</title>
    <link rel="sortcut icon" href="midia/logo.png" type="image/png" />
</head>

<body onload="obterComentarios()">

    <section class="showcase_Game">
        <header>
            <h2 class="logo">The Last of Us</h2>
            <div class="toggle"></div>
        </header>

        <img id="image_begin" src="midia/tlou-light.jpg" alt="">

        <div id="overlay3" class="overlay3"><iframe id="video_yt" width="653" height="400"
                src="https://www.youtube.com/embed/c2o2r2YuxQo?list=PLD17KL9yGdJKnWo5UF3Fz2HiDcXBIQPWh"
                title="YouTube video player" frameborder="0"
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                allowfullscreen></iframe></div>

        <div class="box_streamers">
            <h3 class="streamer">Alanzoka</h3>
        </div>

        <div class="box-videos">
            <h2>Playlist</h2>
            <div class="video-scroll">
                <div class="videos">
                    <div class="video" onclick="change_video(0)">
                        <img src="img streamer/alanzoka01.PNG" alt="">
                        <h3>Um novo começo! - The Last Of Us Part II - Parte 1</h3><br><br>
                    </div>

                    <div class="video" onclick="change_video(1)">
                        <img src="img streamer/alanzoka02.PNG" alt="">
                        <h3>Na patrulha! - The Last Of Us Part II - Parte 2</h3><br><br>
                    </div>

                    <div class="video" onclick="change_video(2)">
                        <img src="img streamer/alanzoka03.PNG" alt="">
                        <h3>Eu não acredito! - The Last Of Us Part II - Parte 3</h3><br><br>
                    </div>

                    <div class="video" onclick="change_video(3)">
                        <img src="img streamer/alanzoka04.PNG" alt="">
                        <h3>Era uma armadilha! - The Last Of Us Part II - Parte 4</h3><br><br>
                    </div>

                    <div class="video" onclick="change_video(4)">
                        <img src="img streamer/alanzoka05.PNG" alt="">
                        <h3>Consequências! - The Last Of Us Part II - Parte 5</h3><br><br>
                    </div>

                    <div class="video" onclick="change_video(5)">
                        <img src="img streamer/alanzoka06.PNG" alt="">
                        <h3>Muitos infectados! - The Last Of Us Part II - Parte 6</h3><br><br>
                    </div>

                    <div class="video" onclick="change_video(6)">
                        <img src="img streamer/alanzoka07.PNG" alt="">
                        <h3>Uma lembrança feliz! - The Last Of Us Part II - Parte 7</h3><br><br>
                    </div>

                    <div class="video" onclick="change_video(7)">
                        <img src="img streamer/alanzoka08.PNG" alt="">
                        <h3>Em busca do arco! - The Last Of Us Part II - Parte 8</h3><br><br>
                    </div>

                    <div class="video" onclick="change_video(8)">
                        <img src="img streamer/alanzoka09.PNG" alt="">
                        <h3>Espreitadores! - The Last Of Us Part II - Parte 9</h3><br><br>
                    </div>

                    <div class="video" onclick="change_video(9)">
                        <img src="img streamer/alanzoka10.PNG" alt="">
                        <h3>Eu tive que fazer isso! - The Last Of Us Part II - Parte 10</h3><br><br>
                    </div>

                    <div class="video" onclick="change_video(10)">
                        <img src="img streamer/alanzoka11.PNG" alt="">
                        <h3>Em busca do aquário! - The Last Of Us Part II - Parte 11</h3><br><br>
                    </div>

                    <div class="video" onclick="change_video(11)">
                        <img src="img streamer/alanzoka12.PNG" alt="">
                        <h3>A tempestade! - The Last Of Us Part II - Parte 12</h3><br><br>
                    </div>

                    <div class="video" onclick="change_video(12)">
                        <img src="img streamer/alanzoka13.PNG" alt="">
                        <h3>O outro lado! - The Last Of Us Part II - Parte 13</h3><br><br>
                    </div>

                    <div class="video" onclick="change_video(13)">
                        <img src="img streamer/alanzoka14.PNG" alt="">
                        <h3>Um passeio no aquário! - The Last Of Us Part II - Parte 14</h3><br><br>
                    </div>

                    <div class="video" onclick="change_video(14)">
                        <img src="img streamer/alanzoka15.PNG" alt="">
                        <h3>Capturada! - The Last Of Us Part II - Parte 15</h3><br><br>
                    </div>

                    <div class="video" onclick="change_video(15)">
                        <img src="img streamer/alanzoka16.PNG" alt="">
                        <h3>Em busca do Owen! - The Last Of Us Part II - Parte 16</h3><br><br>
                    </div>

                    <div class="video" onclick="change_video(16)">
                        <img src="img streamer/alanzoka17.PNG" alt="">
                        <h3>Atrás de suprimentos médicos! - The Last Of Us Part II - Parte 17</h3><br><br>
                    </div>

                    <div class="video" onclick="change_video(17)">
                        <img src="img streamer/alanzoka18.PNG" alt="">
                        <h3>O prédio infectado! - The Last Of Us Part II - Parte 18</h3><br><br>
                    </div>

                    <div class="video" onclick="change_video(18)">
                        <img src="img streamer/alanzoka19.PNG" alt="">
                        <h3>O rei dos ratos! - The Last Of Us Part II - Parte 19</h3><br><br>
                    </div>

                    <div class="video" onclick="change_video(19)">
                        <img src="img streamer/alanzoka20.PNG" alt="">
                        <h3>O sniper! - The Last Of Us Part II - Parte 20</h3><br><br>
                    </div>

                    <div class="video" onclick="change_video(20)">
                        <img src="img streamer/alanzoka21.PNG" alt="">
                        <h3>Esse publicar me quebrou! - The Last Of Us Part II - Parte 21</h3><br><br>
                    </div>

                    <div class="video" onclick="change_video(21)">
                        <img src="img streamer/alanzoka22.PNG" alt="">
                        <h3>Acabou. - The Last Of Us Part II - Parte 22</h3><br><br>
                    </div>
                </div>
            </div>

        </div>

        <div class="box_post">
            <div class="post">
                <h2>Faça um Comentário</h2>
                <form id="form_comentar" method="post" onsubmit="return comentar()">
                    Descrição: <br>
                    <br>
                    <textarea id="textarea_p" rows="4" cols="50" maxlength="500" class="textarea-padrao" name="descricao"></textarea>
                    <br>
                    <button type="submit" id="btn_comentar" class="btn-green">Comentar</button><br>
                </form>
                <div class="extra">
                    <div id="div_erro" class="msg_erro">
                    </div>
                    <!-- <img src="aguarde-orange.gif" id="img_aguarde" class="img_aguarde">  -->
                </div>
            </div>
            <div class="feed">
                <h1>Comentários</h1>
                <div id="feed_container" class="box_coment">
                </div>
            </div>
        </div>
    </section>

    <div class="menu">
        <ul>
            <a href="tempo-real.html">
                <li>Home</li>
            </a>
            <a href="testes.html">
                <li>Testes</li>
            </a>
            <a href="assista.html">
                <li>Assista</li>
            </a>
        </ul>
    </div>

</body>

</html>
<script>

    var menuToggle = document.querySelector('.toggle')
    var showcase = document.querySelector('.showcase_Game')

    menuToggle.addEventListener('click', () => {
        menuToggle.classList.toggle('active')
        showcase.classList.toggle('active')
    })

    var urlVideos = ['https://www.youtube.com/embed/c2o2r2YuxQo?list=RDCMUCIwspRtKNszHhIhl36gREjQ', 'https://www.youtube.com/embed/lnON0Y5LrEc', 'https://www.youtube.com/embed/IBVSx4DXO_0', 'https://www.youtube.com/embed/SzsO08SxHtg?list=RDCMUCIwspRtKNszHhIhl36gREjQ', 'https://www.youtube.com/embed/pa-AIDVmt20?list=RDCMUCIwspRtKNszHhIhl36gREjQ', 'https://www.youtube.com/embed/ndtHBZosQAU?list=RDCMUCIwspRtKNszHhIhl36gREjQ', 'https://www.youtube.com/embed/wQtgBnoROpA?list=RDCMUCIwspRtKNszHhIhl36gREjQ', 'https://www.youtube.com/embed/laPQF2EULHk?list=RDCMUCIwspRtKNszHhIhl36gREjQ', 'https://www.youtube.com/embed/J5ZTVvTagIU?list=RDCMUCIwspRtKNszHhIhl36gREjQ', 'https://www.youtube.com/embed/PPtbAueNZ2I?list=RDCMUCIwspRtKNszHhIhl36gREjQ', 'https://www.youtube.com/embed/4V8Sb77-SM0?list=RDCMUCIwspRtKNszHhIhl36gREjQ', 'https://www.youtube.com/embed/Ti6r6S6Y1Ss?list=RDCMUCIwspRtKNszHhIhl36gREjQ', 'https://www.youtube.com/embed/cAQquuV1co4?list=RDCMUCIwspRtKNszHhIhl36gREjQ', 'https://www.youtube.com/embed/2C7PjcbYcs8?list=RDCMUCIwspRtKNszHhIhl36gREjQ', 'https://www.youtube.com/embed/3HGCSxyZiTE?list=RDCMUCIwspRtKNszHhIhl36gREjQ', 'https://www.youtube.com/embed/ZQxLjKaqA1c?list=PLD17KL9yGdJKnWo5UF3Fz2HiDcXBIQPWh', 'https://www.youtube.com/embed/PwZlWzo9qnw?list=PLD17KL9yGdJKnWo5UF3Fz2HiDcXBIQPWh', 'https://www.youtube.com/embed/k8zNdo6hyQ0?list=PLD17KL9yGdJKnWo5UF3Fz2HiDcXBIQPWh', 'https://www.youtube.com/embed/wnNVDQlO_60?list=PLD17KL9yGdJKnWo5UF3Fz2HiDcXBIQPWh', 'https://www.youtube.com/embed/ABOwEuVFaPA?list=PLD17KL9yGdJKnWo5UF3Fz2HiDcXBIQPWh', 'https://www.youtube.com/embed/xKS3YknmMIc?list=PLD17KL9yGdJKnWo5UF3Fz2HiDcXBIQPWh', 'https://www.youtube.com/embed/AGrAQ44DTOU?list=PLD17KL9yGdJKnWo5UF3Fz2HiDcXBIQPWh'];

    function change_video(index) {
        document.getElementById('video_yt').src = urlVideos[index];
    }

    function comentar() {
        console.log("entrei!")
        // aguardar();
        var formulario = new URLSearchParams(new FormData(form_comentar));
        var idUsuario = sessionStorage.id_usuario_meuapp;
        console.log(sessionStorage.id_usuario_meuapp)
        fetch(`/comentarios/comentar/${idUsuario}`, {
            method: "POST",
            body: formulario
        }).then(resposta => {

            if (resposta.ok) {
                obterComentarios();

                // finalizarAguardar();
            } else {
                console.log('Erro ao comentar!');
                resposta.text().then(texto => {
                    console.error(texto);
                    // finalizarAguardar(texto);
                });
            }
        });

        return false;
    }

    function atualizarFeed(comentarios) {
        var feed = document.getElementById("feed_container");
        feed.innerHTML = "";
        for (let i = 0; i < comentarios.length; i++) {
            var comentario = comentarios[i];

            var divComentario = document.createElement("div")
            var divNome = document.createElement("div")
            var divDescricao = document.createElement("div")

            divNome.innerHTML = `${comentario.nomeUsuario}:`;
            divDescricao.innerHTML = comentario.descricao;

            divComentario.className = "comentario"
            divNome.className = "nome";
            divDescricao.className = "descricao";

            divComentario.appendChild(divNome);
            divComentario.appendChild(divDescricao);

            feed.appendChild(divComentario);
        }
    }

    function obterComentarios() {
        // aguardar();
        fetch("/comentarios")
        .then(resposta => {
            if (resposta.ok) {
                resposta.json().then(function (resposta) {
                    console.log(`Dados recebidos: ${JSON.stringify(resposta)}`);
                   
                    atualizarFeed(resposta);

                    // finalizarAguardar();
                });
            } else {
                console.error('Nenhum dado encontrado ou erro na API');
                finalizarAguardar("Nenhum resultado encontrado ou erro na API");
            }
        })
        .catch(function (error) {
            console.error(`Erro na obtenção dos comentários: ${error.message}`);
        });
    }

    function obterCometariosPorUsuario(idUsuario) {
        fetch(`/comentarios/${idUsuario}`)
        .then(resposta => {
            if (resposta.ok) {
                resposta.json().then(function (resposta) {
                    console.log(`Dados recebidos: ${JSON.stringify(resposta)}`);
                    // alert(JSON.stringify(resposta))
                });
            } else {
                console.error('Nenhum dado encontrado ou erro na API');
            }
        })
        .catch(function (error) {
            console.error(`Erro na obtenção dos comentarios do usuário: ${error.message}`);
        });
    }

    // function aguardar() {
    //     btn_comentar.disabled = true;
    //     img_aguarde.style.visibility = 'visible';
    //     div_erro.style.visibility = 'hidden';
    // }

    // function finalizarAguardar(resposta) {
    //     btn_comentar.disabled = false;
    //     img_aguarde.style.visibility = 'hidden';
    //     if (resposta) {
    //         div_erro.style.visibility = 'visible';
    //         div_erro.innerHTML = resposta;
    //     }
    // }

    verificar_autenticacao();
    
</script>